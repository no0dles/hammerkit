services:
  foodb:
    image: postgres:12-alpine
    needs: [bardb]
    ports: [:5432]

  bardb:
    image: postgres:12-alpine
    needs: [foodb]
    ports: [:5432]

tasks:
  loopservice:
    needs: [foodb]
    cmds:
      - echo bar

  bar:
    deps: [foo]
    cmds:
      - echo bar

  foo:
    deps: [bar]
    cmds:
      - echo foo
